summary(reduced)
summary(full)
summary(reduced)
summary(full)
summary(anova(full,reduced))
anova(full,reduced)
res <- resid(full)
plot(fitted(full), res)
qqnorm(res)
qqline(res)
qqnorm(res)
qqline(res)
plot(density(res))
plot(fitted(full), res)
qqnorm(res)
qqline(res)
plot(density(res))
qqline(res)
qqnorm(res)
qqline(res)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
qqline(res) +
facet_wrap(~ region)
plot(density(res)) +
facet_wrap(~ region)
res <- resid(full) +
facet_wrap(~ region)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
qqline(res) +
facet_wrap(~ region)
plot(density(res)) +
facet_wrap(~ region)
res <- resid(full) +
facet_wrap(~ region)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
res <- resid(full)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
qqline(res) +
facet_wrap(~ region)
plot(density(res)) +
facet_wrap(~ region)
plot(fitted(full), res) +
facet_wrap(~ region)
View(model_3)
res <- resid(model_3)
plot(fitted(full), res) +
facet_wrap(~ region)
#
model_3 <- lm(log(Pb) ~ I(year - 1975) + region, data = Pb_all)
res <- resid(model_3)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
qqline(res) +
facet_wrap(~ region)
plot(density(res)) +
facet_wrap(~ region)
res <- resid(model_3) +
facet_wrap(~ region)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res) +
facet_wrap(~ region)
qqnorm(res)
#b
ggplot(data = Pb_all, aes(x = I(year - 1975), y = Pb)) +
geom_point(size = 2) +
#geom_line(color = "red") +
labs(title = "A small example") +
facet_wrap(~ region)
res <- resid(model_3) +
facet_wrap(~ region)
plot(fitted(full), res) +
facet_wrap(~ region)
res <- resid(model_3)
plot(fitted(full), res) +
facet_wrap(~ region)
qqnorm(res)
qqline(res) +
facet_wrap(~ region)
plot(density(res)) +
facet_wrap(~ region)
qqline(res) +
facet_wrap(~ region)
res <- resid(model_3)
plot(fitted(full), res) +
facet_wrap(~ region)
anova(full,reduced)
#
Pb_all$region <- relevel(Pb_all$region, "Norrbotten")
model_3 <- lm(log(Pb) ~ I(year - 1975) + region, data = Pb_all)
reduced = lm(log(Pb) ~ I(year - 1975), data=Pb_all) # Reduced model
full = lm(log(Pb) ~ I(year - 1975) + region, data=Pb_all) # Full Model
anova(full,reduced)
summary(reduced)
summary(full)
anova(full)
anova(full,reduced)
summary(reduced)
summary(full)
anova(full)
View(Pb_all)
#b
ggplot(data = Pb_all, aes(x = I(year - 1975), y = Pb)) +
geom_point(size = 2) +
#geom_line(color = "red") +
labs(title = "A small example") +
facet_wrap(~ region)
### Lab 3
reduced = lm(log(Pb) ~ I(year - 1975), data=Pb_all) # Reduced model
full = lm(log(Pb) ~ I(year - 1975) + region, data=Pb_all) # Full Model
### Lab 3
m1 = lm(Pb ~ I(year - 1975), data=Pb_all) # Reduced model
m2 = lm(log(Pb) ~ I(year - 1975), data=Pb_all) # Full Model
summary(m1)
plot(hatvalues(m1), type = 'h')
plot(hatvalues(m2), type = 'h')
plot(hatvalues(m1), type = 'h')
plot(hatvalues(m2), type = 'h')
plot(hatvalues(m1), year, type = 'h')
plot(leverage(m1), year, type = 'h')
plot(leverage(m1), type = 'h')
plot(hatvalues(m1), type = 'h')
plot(hatvalues(m1), year, type = 'h')
plot(y = hatvalues(m1)  x = year, type = 'h')
plot(y = hatvalues(m1), x = year, type = 'h')
### Lab 3
m1 = lm(Pb ~ I(year - 1975), data=Pb_all) # Reduced model
m2 = lm(log(Pb) ~ I(year - 1975), data=Pb_all) # Full Model
summary(m1)
plot(y = hatvalues(m1), x = year, type = 'h')
plot(y = hatvalues(m1), x = 'year', type = 'h')
plot(y = hatvalues(m1), aes(x = I(year - 1975), type = 'h')
plot(y = hatvalues(m1), aes(x = I(year - 1975)), type = 'h')
ggplot(y = hatvalues(m1), aes(x = I(year - 1975)), type = 'h')
plot(y = hatvalues(m1), aes(x = I(year - 1975)), type = 'h')
plot(hatvalues(m1))
plot(hatvalues(m2))
influence(m1)$hat
plot(influence(m1)$hat)
plot(influence(m1)$hat, 'h')
plot(influence(m1)$hat)
plot(influence(m2)$hat)
plot(influence(m1)$hat) + geom_point(size = 2)
ggplot(influence(m1)$hat)
plot(influence(m1)$hat)
plot(hatvalues(m1)) + geom_line(color = "red")
plot(hatvalues(m1))
# Activate the ggplot-commands:
library(ggplot2)
load("Data/cod.RData")
# linear model####
cod.linmod <- lm(weight ~ length, data = cod.data)
cod.linsum <- summary(cod.linmod)
# Fitted values, yhat####
cod.data$fit.lin <- predict(cod.linmod)
# Studentized residuals, r*####
cod.data$r.lin <- rstudent(cod.linmod)
# plot r* against yhat and highlight |r*| > 3:
ggplot(data = cod.data, aes(x = fit.lin, y = r.lin)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = cod.data[abs(cod.data$r.lin) > 3, ],
color = "red", size = 4) +
xlab("Predicted weight (g)") +
ylab("Studentized residual") +
#    labs(tag = "A") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
ggplot(data = cod.data, aes(x = fit.lin, y = sqrt(abs(r.lin)))) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(sqrt(qnorm(0.75)), sqrt(2))) +
geom_hline(yintercept = sqrt(3), linetype = 2) +
expand_limits(y = 0) +
xlab("Predicted weight (g)") +
ylab("sqrt(|r*|)") +
labs(title = "Constant variance?",
caption = "0.82, sqrt(2), sqrt(3)") +
theme(text = element_text(size = 18))
# log-log model####
cod.logmod <- lm(log(weight) ~ log(length), data = cod.data)
# Fitted (log)values and Studentized residuals####
cod.data$fit.log <- predict(cod.logmod)
cod.data$r.log <- rstudent(cod.logmod)
plot(hatvalues(m1), year)
year = Pb_all.year
plot(influence(m1)$hat,year)
plot(influence(m1)$hat)
ggplot(influence(m1)$hat)
ggplot(data = Pb_full, influence(m1)$hat)
ggplot(data = Pb_all, influence(m1)$hat)
ggplot(data = Pb_all, aes(x = I(year - 1975)), y = influence(m2)$hat )
ggplot(data = Pb_all, aes(x = I(year - 1975)), y = influence(m2)$hat)
ggplot(data = Pb_all, aes(x = I(year), y = influence(m2)$hat)
ggplot(data = Pb_all, aes(x = year, y = influence(m2)$hat)
ggplot(data = Pb_all, aes(x = I(year - 1975)), y = influence(m2)$hat )
ggplot(data = Pb_all, x = year, y = influence(m2)$hat )
plot(influence(m2)$hat)
ggplot(data = Pb_all, x = year, y = influence(m2)$hat)
plot(influence(m2)$hat)
ggplot(data = Pb_all, x = year, y = hatvalues(m1))
ggplot(data = m1, x = year, y = hatvalues(m1))
ggplot(data = m1, x = year, y = hatvalues(Pb))
ggplot(data = m1, x = year, y = hatvalues(m1))
plot(influence(m2)$hat)
plot(influence(m1)$hat)
leverages = hatvalues(m1)
ggplot(data = Pb_all, aes(x = I(year - 1975)), y = leverages)
ylim=c(-60,10)
ggplot(data = Pb_all, aes(x = I(year - 1975)), y = leverages)
ggplot(data = Pb_all, x= year, y = leverages)
ggplot(data = Pb_all, x= year, y = Pb)
ggplot(data = Pb_all, aes(x= year), y = Pb)
ggplot(data = Pb_all, aes(x= year), y = Pb) +
geom_point(size = 2)
ggplot(data = Pb_all, aes(x= year, y = Pb)) +
geom_point(size = 2)
ggplot(data = Pb_all, aes(x= year, y = Pb)) +
geom_point(size = 2)
ggplot(data = Pb_all, aes(x= year, y = leverages)) +
geom_point(size = 2)
ggplot(data = Pb_all, aes(x= year, y = leverages)) +
geom_jitter(width = 1)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) +
geom_jitter(width = 1)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1)
which.min(hatvalues(m1))
year(which.min(hatvalues(m1)))
year <- Pb_all(, c('year'))
load(Pb_all)
Pb_all(, c('year'))
year(which.min(hatvalues(m1)))
which.min(hatvalues(m1))
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1)
mean(which.min(hatvalues(m1)))
df <- data.frame(Pb_all)
df(29)
df[,29]
df[,c(29)]
df[c(29)]
df[c(29),]
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) +
#geom_jitter(width = 1)
load(Pb_all)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) #+
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) +
geom_jitter(width = 1)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) +
geom_jitter(width = 1)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1)
mean(which.min(hatvalues(m1)))
df <- data.frame(Pb_all)
df[c(29),]
df[c(mean(which.min(hatvalues(m1)))),]
df[c(mean(which.min(hatvalues(m2)))),]
which.min(hatvalues(m2)))
which.min(hatvalues(m2))
leverages = influence(m1)$hat
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m1))) +
geom_jitter(width = 1)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1)
df <- data.frame(Pb_all)
df[c(mean(which.min(hatvalues(m2)))),]
which.min(hatvalues(m2))
df[c(mean(which.min(hatvalues(m2)))),]
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/length(year) )
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/length(year))
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/length(year), data = Pb_all)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/length(1231))
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231)
mean(year)
ggplot(data = Pb_all, aes(x= mean(year), y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231)
ggplot(data = Pb_all, aes(x= year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231)
which.min(hatvalues(m2))
df[c((which.min(hatvalues(m2)))),]
which.min(hatvalues(m2))
geom_hline(yintercept=1/1231) +
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2)))
geom_vline(xintercept=which.min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
min(hatvalues(m2))
x[which.min(hatvalues(m1))]
year[which.min(hatvalues(m1))]
which.min(hatvalues(m1))
hatvalues(m1)
which(hatvalues(m1) == min(hatvalues(m1)))
df[c(which(hatvalues(m1) == min(hatvalues(m1)))),]
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
#geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_jitter(width = 1) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
ggplot(data = Pb_all, aes(x = mean(year), y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
which(hatvalues(m1) == min(hatvalues(m1)))
mean(which(hatvalues(m1) == min(hatvalues(m1))))
which(hatvalues(m1) == min(hatvalues(m1)))
year[which.min(hatvalues(m1))]
df[c(which(hatvalues(m1) == min(hatvalues(m1)))),]
df[c('year'),]
df[,c('year')]
mean(df[,c('year')])
Pb_all$region <- relevel(Pb_all$region, "Norrbotten")
m2 <- lm(log(Pb) ~ I(year - 1975) + region, data = Pb_all)
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
geom_vline(xintercept=which.min(hatvalues(m2)) + 1975)
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/1231) +
geom_hline(yintercept=min(hatvalues(m2))) +
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=min(hatvalues(m2))) +
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=min(hatvalues(m2))) +
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2))) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2), color = region)) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=min(hatvalues(m2)))
ggplot(data = Pb_all, aes(x = year, y = hatvalues(m2), color = region)) +
geom_point(size = 2) +
geom_hline(yintercept=1/523) +
geom_hline(yintercept=1/305) +
geom_hline(yintercept=min(hatvalues(m2)))
View(df)
m2.data$r.lin <- rstudent(m2)
m2$r.lin <- rstudent(m2)
ggplot(data = Pb_all, aes(x = year, y = r.log)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
geom_point(data = cod.data[abs(cod.data$r.log) > 3,],
color = "red", size = 4) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
ggplot(data = Pb_all, aes(x = year, y = r.log)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
ggplot(data = Pb_all, aes(x = year, y = m2)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
Pb_all$r.lin <- rstudent(m2)
ggplot(data = Pb_all, aes(x = year, y = m2)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
ggplot(data = Pb_all, aes(x = year, y = r.lin)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18))
+facet_wrap(~region)
ggplot(data = Pb_all, aes(x = year, y = r.lin)) +
geom_point(size = 3) +
geom_smooth(color = "red") +
geom_hline(yintercept = c(-2, 0, 2)) +
geom_hline(yintercept = c(-3, 3), linetype = 2) +
xlab("Predicted log-weight (ln g)") +
ylab("Studentized residual") +
labs(title = "Studentized residuals vs predicted values Y-hat") +
theme(text = element_text(size = 18)) +
facet_wrap(~region)
cooks.distance(m2)
###B
m2 <- lm(log(Pb) ~ I(year - 1975)*region, data = Pb_all)
summary(m2)
anova(m2)
###B
m0 <- lm(log(Pb) ~ I(year - 1975), data = Pb_all)
m1 <- lm(log(Pb) ~ I(year - 1975)+region, data = Pb_all)
m2 <- lm(log(Pb) ~ I(year - 1975)*region, data = Pb_all)
anova(m0)
summary(m2)
summary(m0)
summary(m1)
summary(m2)
summary(m0)
summary(m1)
summary(m2)
anova(m0)
summary(m0)
AIC(m0)
AIC(m1)
AIC(m2)
BIC(m0)
BIC(m1)
BIC(m2)
summary(m0)
summary(m1)
summary(m2)
summary(m0)$r.squared
summary(m1)$r.squared
summary(m2)$r.squared
summary(m0)$adj.r.squared
summary(m1)$adj.r.squared
summary(m2)$adj.r.squared
AIC(m0)
AIC(m1)
AIC(m2)
BIC(m0)
BIC(m1)
BIC(m2)
AIC(m0)
AIC(m1)
AIC(m2)
summary(m2)
